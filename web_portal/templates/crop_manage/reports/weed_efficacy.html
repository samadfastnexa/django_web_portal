{% extends "admin/base_site.html" %}
{% block title %}Weed Efficacy in Wheat{% endblock %}

{% block extrahead %}
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    .chart-grid { display: grid; grid-template-columns: repeat(2, minmax(280px, 1fr)); gap: 24px; }
    .chart-card { background: #fff; border: 1px solid #e5e7eb; border-radius: 10px; padding: 16px; }
    .chart-card h3 { margin: 0 0 8px; font-weight: 700; font-size: 16px; }
  </style>
{% endblock %}

{% block content %}
<div class="module">
  <h2>Weed Efficacy in Wheat</h2>
  <p>Percent control over time (DAA: Days After Application) for different treatments.</p>
  <div class="chart-grid">
    <div class="chart-card">
      <h3>Chhatri Dodak</h3>
      <canvas id="chartDodak"></canvas>
    </div>
    <div class="chart-card">
      <h3>Jangli Mooli</h3>
      <canvas id="chartMooli"></canvas>
    </div>
    <div class="chart-card">
      <h3>Jangli Haloon</h3>
      <canvas id="chartHaloon"></canvas>
    </div>
    <div class="chart-card">
      <h3>Chandni Booti</h3>
      <canvas id="chartBooti"></canvas>
    </div>
  </div>
</div>

<script>
  const labels = ["Chlodin + Meso 120", "Chlodin + Meso 135", "Chlodin + Meso 150", "Atlantis 100 + 160", "Tri-Ultra 400"]; 

  function makeConfig(title, data7, data14, data21, data28) {
    return {
      type: 'bar',
      data: {
        labels,
        datasets: [
          { label: '7 DAA', data: data7, backgroundColor: '#f59e0b' },
          { label: '14 DAA', data: data14, backgroundColor: '#9ca3af' },
          { label: '21 DAA', data: data21, backgroundColor: '#fbbf24' },
          { label: '28 DAA', data: data28, backgroundColor: '#60a5fa' }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'top' },
          title: { display: false },
          tooltip: { callbacks: { label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y}%` } }
        },
        scales: {
          y: { beginAtZero: true, max: 100, ticks: { callback: (v) => v + '%' } }
        }
      }
    };
  }

  // Data taken from your figures
  const dodak = makeConfig('Dodak', [0,0,0,15,20], [5,5,7,20,25], [10,10,15,40,45], [5,5,10,45,50]);
  const mooli = makeConfig('Mooli', [0,0,0,0,10], [5,5,7,5,15], [10,10,15,10,35], [5,5,10,25,40]);
  const haloon = makeConfig('Haloon', [0,0,0,25,40], [5,5,7,45,70], [10,10,15,75,80], [5,5,10,80,85]);
  const booti = makeConfig('Booti', [0,0,0,5,10], [5,5,7,25,15], [10,10,15,40,25], [5,5,10,45,35]);

  new Chart(document.getElementById('chartDodak'), dodak);
  new Chart(document.getElementById('chartMooli'), mooli);
  new Chart(document.getElementById('chartHaloon'), haloon);
  new Chart(document.getElementById('chartBooti'), booti);
</script>
{% endblock %}